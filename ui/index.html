<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="dark light" />
    <title>Live Speech Translation</title>
    <link rel="stylesheet" href="/ui/style.css" />
  </head>
  <body>
    <div
      class="container"
      role="application"
      aria-label="Live Speech Translation app"
    >
      <!-- Header -->
      <div class="header">
        <h1 aria-label="Live Speech Translation">ğŸŒ Live Speech Translation</h1>
        <p>Real-time translation with voice cloning</p>
      </div>

      <!-- Main Control Section -->
      <div class="main-controls" aria-hidden="false">
        <div class="top-row">
          <div class="state-indicators" aria-hidden="true">
            <div class="state-item" role="status" aria-live="polite">
              <span
                id="stateListening"
                class="state-icon idle"
                title="Listening"
                aria-hidden="true"
                >ğŸ‘‚</span
              >
              <span class="state-label">Listening</span>
            </div>
            <div class="state-item" role="status" aria-live="polite">
              <span
                id="stateTranslating"
                class="state-icon idle"
                title="Translating"
                aria-hidden="true"
                >ğŸ’¬</span
              >
              <span class="state-label">Translating</span>
            </div>
            <div class="state-item" role="status" aria-live="polite">
              <span
                id="stateSpeaking"
                class="state-icon idle"
                title="Speaking"
                aria-hidden="true"
                >ğŸ“¢</span
              >
              <span class="state-label">Speaking</span>
            </div>
          </div>

          <div
            class="input-level-container"
            aria-live="polite"
            aria-atomic="true"
          >
            <label id="micLevelLabel">Mic Input Level:</label>
            <div
              class="input-level-bar-segments"
              id="inputLevelSegments"
              aria-labelledby="micLevelLabel"
              role="img"
              aria-label="Microphone input level"
            >
              <!-- Segments will be dynamically added/removed by JavaScript -->
            </div>
          </div>

          <div class="control-group">
            <label for="ttsModelSelect">TTS Model:</label>
            <select
              id="ttsModelSelect"
              class="model-select"
              title="Select TTS Model"
              aria-label="Select Text-to-Speech model"
            >
              <option value="piper">Piper "Faster Generic"</option>
              <option value="xtts_v2">XTTS v2 (to be implemented)</option>
            </select>
          </div>
        </div>

        <!-- Control Buttons moved here -->
        <div class="control-buttons">
          <button id="initBtn" class="btn btn-init" aria-live="polite">
            Initialize
          </button>
          <button id="startBtn" class="btn btn-start" disabled>Start</button>
          <button id="stopBtn" class="btn btn-stop" disabled>Stop</button>
          <div class="status-indicator" aria-hidden="true">
            <span
              id="statusIndicator"
              class="indicator off"
              aria-hidden="true"
            ></span>
            <span id="statusLabel">Ready</span>
          </div>
        </div>
      </div>

      <!-- Main content: Two columns -->
      <div class="content">
        <!-- Left Column: Transcription -->
        <div class="column transcription-column" aria-live="polite">
          <div class="column-header">
            <h2>ğŸ“ Transcription</h2>
            <span
              id="inputLanguageBadge"
              class="language-badge"
              aria-hidden="true"
              >EN</span
            >
            <label for="inputLanguageSelect" class="visually-hidden"
              >Input language</label
            >
            <select
              id="inputLanguageSelect"
              class="language-select"
              title="Select Input Language"
              aria-label="Select input language"
            >
              <option value="en" selected>English (English)</option>
              <option value="es">Spanish (EspaÃ±ol)</option>
              <option value="fr">French (FranÃ§ais)</option>
              <option value="de">German (Deutsch)</option>
              <option value="it">Italian (Italiano)</option>
              <option value="pt">Portuguese (PortuguÃªs)</option>
              <option value="pl">Polish (Polski)</option>
              <option value="tr">Turkish (TÃ¼rkÃ§e)</option>
              <option value="ru">Russian (Ğ ÑƒÑÑĞºĞ¸Ğ¹)</option>
              <option value="nl">Dutch (Nederlands)</option>
              <option value="cs">Czech (ÄŒeÅ¡tina)</option>
              <option value="ar">Arabic (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)</option>
              <option value="zh-cn">Chinese (ä¸­æ–‡)</option>
              <option value="ja">Japanese (æ—¥æœ¬èª)</option>
              <option value="hu">Hungarian (Magyar)</option>
              <option value="ko">Korean (í•œêµ­ì–´)</option>
              <option value="hi">Hindi (à¤¹à¤¿à¤¨à¥à¤¦à¥€)</hi>
            </select>
          </div>
          <div
            class="transcript-box"
            id="transcriptionBox"
            tabindex="0"
            role="region"
            aria-label="Transcription output"
          >
            <p class="placeholder">Waiting for speech...</p>
          </div>
        </div>

        <!-- Divider -->
        <div class="divider" aria-hidden="true"></div>

        <!-- Right Column: Translation -->
        <div class="column translation-column" aria-live="polite">
          <div class="column-header">
            <h2>ğŸ—£ï¸ Translation</h2>
            <span
              id="outputLanguageBadge"
              class="language-badge"
              aria-hidden="true"
              >CS</span
            >
            <label for="outputLanguageSelect" class="visually-hidden"
              >Output language</label
            >
            <select
              id="outputLanguageSelect"
              class="language-select"
              title="Select Target Language"
              aria-label="Select target language"
            >
              <option value="en">English (English)</option>
              <option value="es">Spanish (EspaÃ±ol)</option>
              <option value="fr">French (FranÃ§ais)</option>
              <option value="de">German (Deutsch)</option>
              <option value="it">Italian (Italiano)</option>
              <option value="pt">Portuguese (PortuguÃªs)</option>
              <option value="pl">Polish (Polski)</option>
              <option value="tr">Turkish (TÃ¼rkÃ§e)</option>
              <option value="ru">Russian (Ğ ÑƒÑÑĞºĞ¸Ğ¹)</option>
              <option value="nl">Dutch (Nederlands)</option>
              <option value="cs" selected>Czech (ÄŒeÅ¡tina)</option>
              <option value="ar">Arabic (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)</option>
              <option value="zh-cn">Chinese (ä¸­æ–‡)</option>
              <option value="ja">Japanese (æ—¥æœ¬èª)</option>
              <option value="hu">Hungarian (Magyar)</option>
              <option value="ko">Korean (í•œêµ­ì–´)</option>
              <option value="hi">Hindi (à¤¹à¤¿à¤¨à¥à¤¦à¥€)</hi>
            </select>
          </div>
          <div
            class="transcript-box"
            id="translationBox"
            tabindex="0"
            role="region"
            aria-label="Translation output"
          >
            <p class="placeholder">Translation will appear here...</p>
          </div>
        </div>
      </div>

      <!-- Latency Metrics -->
      <div class="latency-metrics" role="status" aria-live="polite">
        <h3>Latency Breakdown</h3>
        <div class="metric-group">
          <div class="metric">
            <span class="metric-label">Input to STT:</span>
            <span class="metric-value" id="inputToSttTime">0.0s</span>
          </div>
          <div class="metric">
            <span class="metric-label">STT to MT:</span>
            <span class="metric-value" id="sttToMtTime">0.0s</span>
          </div>
          <div class="metric">
            <span class="metric-label">MT to TTS:</span>
            <span class="metric-value" id="mtToTtsTime">0.0s</span>
          </div>
          <div class="metric">
            <span class="metric-label">TTS to Playback:</span>
            <span class="metric-value" id="ttsToPlaybackTime">0.0s</span>
          </div>
          <div class="metric">
            <span class="metric-label">Backend Pipeline:</span>
            <span class="metric-value" id="totalPipelineTime">0.0s</span>
          </div>
          <div class="metric total-e2e">
            <span class="metric-label">Total E2E Latency:</span>
            <span class="metric-value" id="totalE2ELatency">0.0s</span>
          </div>
        </div>
        <!-- Timeline Chart Canvas -->
        <div class="timeline-chart-container">
          <canvas id="latencyTimelineChart"></canvas>
        </div>
      </div>

      <div class="settings-status" role="status" aria-live="polite">
        <span id="settingsStatusText" class="metric-value"></span>
      </div>
      <div
        class="log-container"
        role="log"
        aria-live="polite"
        aria-atomic="false"
      >
        <h3>Activity Log</h3>
        <div id="activityLog" class="activity-log-box" tabindex="0">
          <!-- Log messages will be appended here -->
        </div>
      </div>
    </div>

    <!-- Chart.js CDN for latency timeline visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <script src="/ui/script.js"></script>
  </body>
</html>
